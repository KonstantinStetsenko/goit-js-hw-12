{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport { search } from '../main';\nimport { _page } from '../main';\nimport { refs } from '../main';\nexport let searchTerm = 0;\nsearchTerm = search;\nexport let arrData = [];\nexport let totalImage = 1;\nexport let totalPages = 0;\nexport let _per_page = 15;\nconst API_KEY = '35615577-2bf6ed1d70f9a1c328f0e4a49';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchGallery(search) {\n  arrData = []; // Очистка перед новым запросом\n  try {\n    const response = await axios({\n      url: BASE_URL,\n      params: {\n        key: API_KEY,\n        q: search,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: _per_page,\n        page: _page,\n      },\n    });\n\n    arrData = response.data.hits;\n    totalImage = response.data.totalHits;\n    totalPages = totalImage / _per_page;\n  } catch (error) {\n    console.error('Error fetching data:', error);\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { arrData } from './pixabay-api';\n// import { userConteinerUL } from '../main';\nimport { refs } from '../main';\n// const gallery = document.querySelector('.gallery');\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function renderGallery(arrData) {\n  if (arrData.length === 0) {\n    console.log('Нет данных для отображения');\n    return;\n  }\n\n  const markup = arrData\n    .map(data2 => {\n      return `<li class=\"list-photo\">\n                <div class=\"gallery\">\n                  <a href=\"${data2.largeImageURL}\" class=\"gallery-item\">\n                    <img src=\"${data2.webformatURL}\" alt=\"${data2.tags}\" loading=\"lazy\" />\n                  </a>\n                </div>\n                <div class=\"container-total\">\n                  <div class=\"item\">\n                    <h2 class=\"head-photo\">likes</h2>\n                    <p class=\"total-photo\">${data2.likes}</p>\n                  </div>\n                  <div class=\"item\">\n                    <h2 class=\"head-photo\">views</h2>\n                    <p class=\"total-photo\">${data2.views}</p>\n                  </div>\n                  <div class=\"item\">\n                    <h2 class=\"head-photo\">comments</h2>\n                    <p class=\"total-photo\">${data2.comments}</p>\n                  </div>\n                  <div class=\"item\">\n                    <h2 class=\"head-photo\">downloads</h2>\n                    <p class=\"total-photo\">${data2.downloads}</p>\n                  </div>\n                </div>\n              </li>`;\n    })\n    .join('');\n\n  refs.userContainerUL.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { arrData, fetchGallery, totalImage } from './js/pixabay-api';\nimport { renderGallery } from './js/render-functions';\nimport { totalPages } from './js/pixabay-api';\nimport { _per_page } from './js/pixabay-api';\n\nexport let search = '';\nexport let _page = 1;\n\nexport const refs = {\n  userContainerUL: document.querySelector('.users-list'),\n  loader: document.querySelector('.loader'),\n  loaderButton: document.querySelector('.loader-button'),\n  form: document.querySelector('.form-serch'), // форма поиска\n  btn: document.querySelector('.loadButton'), // кнопка загрузки\n  gallery: document.querySelector('.gallery'),\n  input: document.querySelector('.input-serch'), // поле ввода поиска\n};\n\n// Показать или скрыть лоадер\nfunction showLoader() {\n  refs.loader.classList.add('loader');\n}\nfunction hideLoader() {\n  refs.loader.classList.remove('loader');\n}\n\n// Показать или скрыть лоадер кнопки\nfunction showLoaderButton() {\n  refs.loaderButton.style.display = 'flex';\n}\nfunction hideLoaderButton() {\n  refs.loaderButton.style.display = 'none';\n}\n\n// Показать или скрыть кнопку\nfunction showBtn() {\n  refs.btn.classList.remove('buttonHiden');\n}\nfunction hideBtn() {\n  refs.btn.classList.add('buttonHiden');\n}\n\n// Скрываем лоадер при загрузке страницы\ndocument.addEventListener('DOMContentLoaded', () => {\n  hideLoader();\n});\n\n// Очистка страницы\nfunction clearPage() {\n  if (refs.userContainerUL) {\n    refs.userContainerUL.innerHTML = '';\n  }\n}\n\n// Обработка отправки формы\nasync function handleFormSubmit(event) {\n  if (totalPages === 1) {\n    hideBtn(); // Если только одна страница, скрываем кнопку \"Load More\"\n    console.log('Только одня страница, скрываем кнопку');\n  }\n  event.preventDefault(); // предотвращаем перезагрузку страницы\n  clearPage();\n  search = refs.input.value.trim(); // убираем лишние пробелы\n  _page = 1;\n\n  if (!search) {\n    hideBtn();\n    hideLoader();\n    iziToast.warning({\n      message: 'Запрос пустой',\n      backgroundColor: '#ffa500',\n      messageSize: 16,\n      messageColor: '#FFF',\n      iconColor: '',\n      titleColor: '#fa0598e5',\n      icon: 'info-outline',\n      titleSize: 16,\n      messageLineHeight: 24,\n      position: 'topRight',\n    });\n    return;\n  }\n\n  showLoader(); // показываем лоадер\n\n  try {\n    await fetchGallery(search); // выполняем запрос по ключевому слову\n\n    if (arrData.length === 0) {\n      hideBtn();\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        backgroundColor: '#ffa500',\n        messageSize: 16,\n        messageColor: '#FFF',\n        iconColor: '',\n        titleColor: '#ffa500',\n        icon: 'info-outline',\n        titleSize: 16,\n        messageLineHeight: 24,\n        position: 'topRight',\n      });\n    } else {\n      renderGallery(arrData); // отрисовываем результаты\n\n      if (arrData.length >= _per_page) {\n        showBtn();\n      }\n    }\n\n    hideLoader(); // скрываем лоадер\n  } catch (error) {\n    console.error('Ошибка при получении данных:', error);\n    hideLoader();\n    iziToast.error({\n      message: 'Произошла ошибка при загрузке данных',\n      backgroundColor: '#ff0000',\n      position: 'topRight',\n    });\n  }\n\n  refs.input.value = ''; // очищаем поле ввода\n}\n\n// Добавляем обработчик события на отправку формы\nrefs.form.addEventListener('submit', handleFormSubmit);\nhideLoaderButton();\n\n// Обработка кнопки загрузки следующей страницы\nrefs.btn.addEventListener('click', async () => {\n  try {\n    _page += 1; // увеличиваем номер страницы при клике\n\n    if (_page > totalPages) {\n      renderGallery(arrData); // Отрисовываем последнюю страницу\n      hideBtn();\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        backgroundColor: '#ffa500',\n        messageSize: 16,\n        messageColor: '#FFF',\n        iconColor: '',\n        titleColor: '#fa0598e5',\n        icon: 'info-outline',\n        titleSize: 16,\n        messageLineHeight: 24,\n        position: 'topRight',\n      });\n      return;\n    }\n\n    showLoaderButton(); // показываем лоадер кнопки\n    await fetchGallery(search, _page); // загружаем следующую страницу\n\n    renderGallery(arrData); // отрисовываем данные\n    smoothScroll();\n  } catch (error) {\n    console.log('Ошибка при загрузке следующей страницы:', error);\n    iziToast.error({\n      message: 'Ошибка при загрузке следующей страницы',\n      backgroundColor: '#ff0000',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoaderButton(); // всегда скрываем лоадер кнопки\n  }\n});\n\n// Скрол страницы\nfunction smoothScroll() {\n  const lastArticle = refs.userContainerUL.lastElementChild;\n  const ArticleHeight = lastArticle.getBoundingClientRect().height;\n  const scrolHeight = ArticleHeight * 2;\n\n  window.scrollBy({\n    top: scrolHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n  console.log(`Страница ${_page}`);\n}\n"],"names":["arrData","totalImage","totalPages","_per_page","API_KEY","BASE_URL","fetchGallery","search","response","axios","_page","error","lightbox","SimpleLightbox","renderGallery","markup","data2","refs","showLoader","hideLoader","showLoaderButton","hideLoaderButton","showBtn","hideBtn","clearPage","handleFormSubmit","event","iziToast","smoothScroll","scrolHeight"],"mappings":"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"}